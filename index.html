<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>検定サイト（HTML+CSS+JSのみ）</title>

  <!-- GitHub Pages(プロジェクトサイト)は /test4/ がルート -->
  <link rel="icon" type="image/svg+xml" href="/test4/favicon.svg">
  <link rel="stylesheet" href="styles.css" />
</head>
<body id="app-root">
  <header>
    <nav class="nav">
      <div class="brand">
        <span class="logo">🏅</span>
        <span>検定ポータル</span>
      </div>
      <a href="#/" data-link>ホーム</a>
      <a href="#/exam" data-link>検定ページ</a>
      <a href="#/certificate" data-link>合格証書</a>
      <span class="spacer"></span>
      <span id="userBadge" class="tag">未ログイン</span>
      <button class="btn" id="logoutBtn" style="display:none">ログアウト</button>
    </nav>
  </header>

  <main>
    <!-- Home -->
   <section class="card pad" data-route="/exam" style="display:none">
  <div class="row" style="justify-content:space-between; gap:12px">
    <h2 style="margin:0">検定ページ</h2>
    <span class="tag">CSV対応・級選択</span>
  </div>
  <p class="muted">「1級（難）〜4級（入門）」を選んで開始。<code>questions.csv</code> または <code>question.csv</code> があれば自動読込します。</p>

  <!-- ▼ メニュー -->
  <section class="card inner" id="menu">
    <h3 style="margin-top:0">級を選んでスタート</h3>
    <div class="grid4" id="grade-list">
      <div class="grade" data-grade="1"><span class="badge">1級</span><h4>エキスパート</h4><div class="small muted">応用・難問中心</div></div>
      <div class="grade" data-grade="2"><span class="badge">2級</span><h4>上級</h4><div class="small muted">標準＋やや難</div></div>
      <div class="grade" data-grade="3"><span class="badge">3級</span><h4>中級</h4><div class="small muted">基礎の確認</div></div>
      <div class="grade" data-grade="4"><span class="badge">4級</span><h4>入門</h4><div class="small muted">初めての方に</div></div>
    </div>

    <div class="row" style="margin-top:12px;">
      <button class="btn primary" id="btn-start" type="button">この級で受験を開始</button>
      <input id="file-questions" type="file" accept=".csv,text/csv" style="display:none">
      <button class="btn" id="btn-import" type="button" title="Excelから書き出したCSVを読み込む">問題CSVを読み込む</button>
      <span class="muted" id="selected-grade-label"></span>
      <span class="spacer"></span>
      <span class="tag">総問題数: <span id="total-count">0</span></span>
    </div>
  </section>

  <!-- ▼ 説明 -->
  <section id="intro" class="card inner hidden">
    <div class="muted">説明：各設問に回答してください（全問出題）。</div>
  </section>

  <!-- ▼ 受験画面 -->
  <section id="quiz" class="card inner hidden">
    <div id="hud" class="hud">
      <span id="hud-time" class="badge">残り時間: 00:00</span>
      <span id="hud-remaining" class="badge">残り問題数: 0問</span>
    </div>

    <div style="display:flex;justify-content:flex-end;gap:8px;margin-bottom:8px;">
      <button class="btn" id="btn-back-menu" type="button">メニューに戻る</button>
    </div>

    <div id="qtext"><strong>Q.</strong> …</div>
    <div class="choices" id="choices"></div>

    <div style="margin-top:12px; display:flex; gap:8px; align-items:center;">
      <button id="btn-prev" class="btn" type="button" disabled>前の問題へ</button>
      <button class="btn primary" id="btn-next" type="button">次へ</button>
      <span class="muted" id="progress">0 / 0</span>
    </div>
  </section>

  <!-- ▼ 結果 -->
  <section id="summary" class="card inner hidden">
    <h3 style="margin-top:0">結果</h3>
    <div id="score"></div>
    <div style="margin-top:12px;">
      <button class="btn" id="btn-retry" type="button">メニューに戻る</button>
      <a class="btn" href="#/certificate">合格証を見る</a>
    </div>
  </section>
</section>

    <!-- Login -->
    <section class="card pad" data-route="/login" style="display:none">
      <h2 style="margin-top:0">会員ログイン</h2>
      <form id="loginForm">
        <div>
          <label for="name">お名前（証書に印字されます）</label>
          <input id="name" name="name" type="text" placeholder="例）山田 太郎" required />
        </div>
        <div class="row">
          <button type="submit" class="btn primary">ログイン</button>
          <span class="muted">※ パスワード不要のデモ仕様</span>
        </div>
      </form>
    </section>

    <!-- Exam -->
    <section class="card pad" data-route="/exam" style="display:none">
      <div class="row" style="justify-content:space-between; gap:12px">
        <h2 style="margin:0">検定ページ</h2>
        <span class="tag">合格ライン：80点</span>
      </div>
      <p class="muted">以下のボタンから検定を開始してください。問題は全部で <span id="totalCount">0</span> 問です。</p>
      <div class="row">
        <button class="btn primary" id="startExamBtn">検定を開始</button>
        <a class="btn" href="#/certificate">合格証を見る</a>
      </div>
      <hr style="border-color: rgba(255,255,255,.12)"/>
      <div class="progress"><span id="progressBar"></span></div>

      <div id="questionArea" style="margin-top:16px; display:none">
        <div class="question">
          <h3 id="qTitle">問題タイトル</h3>
          <p id="qText" class="muted" style="margin:.3rem 0 1rem"></p>
          <div class="choices" id="choiceList"></div>
        </div>
        <div class="row" style="margin-top:12px">
          <button class="btn" id="prevBtn">前へ</button>
          <div class="spacer"></div>
          <span class="muted" id="pageInfo">1 / 1</span>
          <button class="btn" id="nextBtn">次へ</button>
          <button class="btn good" id="submitBtn" style="display:none">採点する</button>
        </div>
        <div class="result" id="resultBox"></div>
      </div>
    </section>

    <!-- Certificate -->
    <section class="card pad" data-route="/certificate" style="display:none">
      <h2 style="margin-top:0">合格証書</h2>
      <p class="muted">合格後に自動生成されます。ログイン名・日付・点数が印字されます。</p>
      <div id="certWrap" style="display:grid; gap:12px">
        <canvas id="certCanvas" width="1200" height="850" aria-label="合格証書プレビュー"></canvas>
        <div class="row">
          <button class="btn" id="renderCertBtn">再生成</button>
          <a id="downloadCert" class="btn primary" download="certificate.png">画像をダウンロード</a>
          <span class="spacer"></span>
          <a class="btn" href="#/exam">検定に戻る</a>
        </div>
      </div>
    </section>
  </main>

  <footer>© <span id="year"></span> 検定ポータル. HTML+CSS+JSのみで構築。</footer>

  <script src="app.js" defer></script>
</body>
</html>

